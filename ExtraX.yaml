name: Windows.Memory.ExtraX

precondition: SELECT OS From info() where OS = 'windows'

sources:
  - query: |
    LET GetPids =
      SELECT Pid,
        Name
      FROM pslist()

    LET Compare =
      SELECT Pid,
        Name,
        MappingName,
        Protection
      FROM vad(pid=Pid)
      WHERE Protection =~ "x"
        AND NOT MappingName

    SELECT * FROM foreach(
      row=GetPids,
      query=Compare
    )
